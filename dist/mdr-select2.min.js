!function(){"use strict";angular.module("mdr.select2",[]).directive("mdrSelect2",[function(){return{restrict:"E",controller:"mdrSelect2Ctrl",scope:{url:"@",src:"=",options:"@",model:"=",selected:"=",allowClear:"@",placeholder:"@",disabled:"=",required:"="},template:'<select class="form-control select2" id="selectId_{{$id}}" ng-options="{{options}}" ng-model="model" ng-disabled="disabled" ng-required="required"><option></option></select>'}}]).controller("mdrSelect2Ctrl",["$scope","$element","$attrs","mdrSelect2Service",function(e,t,o,l){function c(){setTimeout(function(){$("#selectId_"+e.$id).select2({placeholder:e.placeholder,allowClear:e.allowClear})},0)}function n(t){setTimeout(function(){$("#selectId_"+e.$id).select2({placeholder:t})},0)}function i(t){var o=r();angular.forEach(e[o.collection],function(l,c){return t==l[o.track]?(e.model=l,setTimeout(function(){$("#selectId_"+e.$id).val(t).trigger("change")},0),!1):void 0})}function r(){var t=e.options.split(" "),o=t.indexOf("in"),l=t.indexOf("track"),c=t[l+2].split("."),n={collection:t[o+1],track:c[1]};return n}e.placeholder="Select",e.allowClear=!1,c(),e.$watch("url",function(t,o){if(void 0!==t){var d=r();e[d.collection]=[],n("Loading..."),l.find(t).then(function(t){t.length<=0||void 0===t.length?n("No results found"):(e[d.collection]=t,c(),void 0!==e.selected&&i(e.selected))})["catch"](function(e){n("No results found")})}}),e.$watchCollection("src",function(t,o){if(void 0!==t){var l=r();e[l.collection]=t,c(),void 0!==e.selected&&i(e.selected)}}),e.$watch("model",function(t,o){(void 0===t||null===t)&&(e.model={})}),e.$watch("selected",function(e,t){void 0!==e&&i(e)})}]).factory("mdrSelect2Service",["$http","$q",function(e,t){return{find:function(o){var l=t.defer();return e.get(o).success(function(e){l.resolve(e)}).error(function(e){l.reject(e)}),l.promise}}}])}();