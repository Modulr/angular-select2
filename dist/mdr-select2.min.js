!function(){"use strict";angular.module("mdr.select2",[]).directive("mdrSelect2",[function(){return{restrict:"E",controller:"mdrSelect2Ctrl",scope:{url:"@",src:"=",options:"@",model:"=",selected:"=",allowClear:"@",placeholder:"@",disabled:"=",required:"="},template:'<select class="form-control select2" id="selectId_{{$id}}" ng-options="{{options}}" ng-model="model" ng-disabled="disabled" ng-required="required"><option></option></select>'}}]).controller("mdrSelect2Ctrl",["$scope","$element","$attrs","mdrSelect2Service",function(e,t,l,c){function o(){setTimeout(function(){$("#selectId_"+e.$id).select2({placeholder:e.placeholder,allowClear:e.allowClear})},0)}function n(t){var l=r();angular.forEach(e[l.collection],function(c,o){return t==c[l.track]?(e.model=c,setTimeout(function(){$("#selectId_"+e.$id).val(t).trigger("change")},0),!1):void 0})}function r(){var t=e.options.split(" "),l=t.indexOf("in"),c=t.indexOf("track"),o=t[c+2].split("."),n={collection:t[l+1],track:o[1]};return n}e.placeholder="Select",e.allowClear=!1,o(),e.$watch("url",function(t,l){if(void 0!==t){var i=r();c.find(t).then(function(t){e[i.collection]=t,o(),void 0!==e.selected&&n(e.selected)})}}),e.$watchCollection("src",function(t,l){if(void 0!==t){var c=r();e[c.collection]=t,o(),void 0!==e.selected&&n(e.selected)}}),e.$watch("model",function(t,l){void 0!==t&&null!==t&&0===Object.keys(t).length&&setTimeout(function(){$("#selectId_"+e.$id).val(null).trigger("change")},0)}),e.$watch("selected",function(e,t){void 0!==e&&n(e)})}]).factory("mdrSelect2Service",["$http","$q",function(e,t){return{find:function(l){var c=t.defer();return e.get(l).success(function(e){c.resolve(e)}).error(function(e){c.reject(e)}),c.promise}}}])}();